-- DDL from GORM models
-- Generated by schema tool
-- DO NOT EDIT THIS FILE DIRECTLY

-- Table: email_configs
CREATE TABLE `email_configs` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `created_at` datetime(3) DEFAULT NULL,
  `updated_at` datetime(3) DEFAULT NULL,
  `creator` bigint DEFAULT NULL,
  `deleted_at` datetime(3) DEFAULT NULL,
  `namespace_uid` bigint DEFAULT NULL,
  `name` varchar(191) COLLATE utf8mb4_general_ci DEFAULT NULL,
  `host` longtext COLLATE utf8mb4_general_ci,
  `port` int DEFAULT NULL,
  `username` longtext COLLATE utf8mb4_general_ci,
  `password` longtext COLLATE utf8mb4_general_ci,
  `status` int DEFAULT '0',
  PRIMARY KEY (`id`),
  UNIQUE KEY `email_config__namespace_uid__name` (`deleted_at`,`namespace_uid`,`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Table: members
CREATE TABLE `members` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `created_at` datetime(3) NOT NULL,
  `updated_at` datetime(3) NOT NULL,
  `deleted_at` datetime(3) DEFAULT NULL,
  `creator` bigint NOT NULL,
  `namespace_uid` bigint NOT NULL,
  `user_uid` bigint NOT NULL,
  `status` int NOT NULL DEFAULT '1',
  `name` varchar(191) COLLATE utf8mb4_general_ci NOT NULL DEFAULT '',
  `nickname` varchar(191) COLLATE utf8mb4_general_ci NOT NULL DEFAULT '',
  `avatar` varchar(191) COLLATE utf8mb4_general_ci NOT NULL DEFAULT '',
  `remark` varchar(191) COLLATE utf8mb4_general_ci NOT NULL DEFAULT '',
  `email` varchar(191) COLLATE utf8mb4_general_ci NOT NULL DEFAULT '',
  `phone` varchar(191) COLLATE utf8mb4_general_ci NOT NULL DEFAULT '',
  PRIMARY KEY (`id`),
  UNIQUE KEY `idx__member__namespace_uid__user_uid` (`namespace_uid`,`user_uid`),
  KEY `idx_members_deleted_at` (`deleted_at`),
  KEY `idx_members_creator` (`creator`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Table: message_logs
CREATE TABLE `message_logs` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `created_at` datetime(3) DEFAULT NULL,
  `updated_at` datetime(3) DEFAULT NULL,
  `creator` bigint DEFAULT NULL,
  `namespace_uid` bigint DEFAULT NULL,
  `send_at` datetime(3) DEFAULT NULL,
  `message` longtext COLLATE utf8mb4_general_ci,
  `config` longtext COLLATE utf8mb4_general_ci,
  `type` int DEFAULT '0',
  `status` int DEFAULT '0',
  `retry_total` int DEFAULT '0',
  `last_error` longtext COLLATE utf8mb4_general_ci,
  PRIMARY KEY (`id`),
  KEY `idx__message_log__namespace_uid` (`namespace_uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Table: message_retry_logs
CREATE TABLE `message_retry_logs` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `created_at` datetime(3) DEFAULT NULL,
  `updated_at` datetime(3) DEFAULT NULL,
  `creator` bigint DEFAULT NULL,
  `namespace_uid` bigint DEFAULT NULL,
  `message_log_id` bigint DEFAULT NULL,
  `retry_at` datetime(3) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `idx__message_retry_log__namespace_uid` (`namespace_uid`),
  KEY `idx__message_retry_log__message_log_id` (`message_log_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Table: namespaces
CREATE TABLE `namespaces` (
  `id` int unsigned NOT NULL AUTO_INCREMENT,
  `uid` bigint NOT NULL,
  `created_at` datetime(3) NOT NULL,
  `updated_at` datetime(3) NOT NULL,
  `creator` bigint NOT NULL,
  `deleted_at` datetime(3) DEFAULT NULL,
  `name` varchar(100) COLLATE utf8mb4_general_ci NOT NULL,
  `metadata` json DEFAULT NULL,
  `status` int NOT NULL DEFAULT '0',
  `remark` varchar(1000) COLLATE utf8mb4_general_ci NOT NULL DEFAULT '',
  PRIMARY KEY (`id`),
  UNIQUE KEY `idx_namespaces_uid` (`uid`),
  UNIQUE KEY `idx__namespace__name__deleted_at` (`deleted_at`,`name`),
  KEY `idx_namespaces_creator` (`creator`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Table: recipient_group__email_configs
CREATE TABLE `recipient_group__email_configs` (
  `recipient_group_id` bigint NOT NULL,
  `email_config_id` bigint NOT NULL,
  PRIMARY KEY (`recipient_group_id`,`email_config_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Table: recipient_group__members
CREATE TABLE `recipient_group__members` (
  `recipient_group_id` bigint NOT NULL,
  `recipient_member_id` bigint NOT NULL,
  PRIMARY KEY (`recipient_group_id`,`recipient_member_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Table: recipient_group__templates
CREATE TABLE `recipient_group__templates` (
  `recipient_group_id` bigint NOT NULL,
  `template_id` bigint NOT NULL,
  PRIMARY KEY (`recipient_group_id`,`template_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Table: recipient_group__webhooks
CREATE TABLE `recipient_group__webhooks` (
  `recipient_group_id` bigint NOT NULL,
  `webhook_config_id` bigint NOT NULL,
  PRIMARY KEY (`recipient_group_id`,`webhook_config_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Table: recipient_groups
CREATE TABLE `recipient_groups` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `created_at` datetime(3) DEFAULT NULL,
  `updated_at` datetime(3) DEFAULT NULL,
  `creator` bigint DEFAULT NULL,
  `deleted_at` datetime(3) DEFAULT NULL,
  `namespace_uid` bigint DEFAULT NULL,
  `name` varchar(191) COLLATE utf8mb4_general_ci DEFAULT NULL,
  `metadata` json DEFAULT NULL,
  `status` int DEFAULT '0',
  PRIMARY KEY (`id`),
  UNIQUE KEY `recipient_group__namespace_uid__name` (`deleted_at`,`namespace_uid`,`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Table: recipient_members
CREATE TABLE `recipient_members` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `created_at` datetime(3) DEFAULT NULL,
  `updated_at` datetime(3) DEFAULT NULL,
  `creator` bigint DEFAULT NULL,
  `namespace_uid` bigint DEFAULT NULL,
  `user_uid` bigint DEFAULT NULL,
  `email` longtext COLLATE utf8mb4_general_ci,
  `phone` longtext COLLATE utf8mb4_general_ci,
  `status` int DEFAULT '0',
  PRIMARY KEY (`id`),
  UNIQUE KEY `recipient_member__namespace_uid__user_uid` (`namespace_uid`,`user_uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Table: templates
CREATE TABLE `templates` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `created_at` datetime(3) DEFAULT NULL,
  `updated_at` datetime(3) DEFAULT NULL,
  `creator` bigint DEFAULT NULL,
  `deleted_at` datetime(3) DEFAULT NULL,
  `namespace_uid` bigint DEFAULT NULL,
  `name` varchar(191) COLLATE utf8mb4_general_ci DEFAULT NULL,
  `message_type` int DEFAULT '0',
  `json_data` longblob,
  `status` int DEFAULT '0',
  PRIMARY KEY (`id`),
  UNIQUE KEY `template__namespace_uid__name` (`deleted_at`,`namespace_uid`,`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Table: user_oauth2s
CREATE TABLE `user_oauth2s` (
  `id` int unsigned NOT NULL AUTO_INCREMENT,
  `created_at` datetime(3) NOT NULL,
  `updated_at` datetime(3) NOT NULL,
  `open_id` varchar(100) COLLATE utf8mb4_general_ci NOT NULL,
  `name` varchar(100) COLLATE utf8mb4_general_ci NOT NULL DEFAULT '',
  `email` varchar(100) COLLATE utf8mb4_general_ci NOT NULL DEFAULT '',
  `avatar` varchar(100) COLLATE utf8mb4_general_ci NOT NULL DEFAULT '',
  `app` varchar(100) COLLATE utf8mb4_general_ci NOT NULL,
  `raw` json DEFAULT NULL,
  `user_id` bigint NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `idx__oauth2_user__app__open_id` (`open_id`,`app`),
  KEY `idx__oauth2_user__email` (`email`),
  KEY `idx__oauth2_user__user_uid` (`user_id`),
  KEY `idx__oauth2_user__user_id` (`user_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Table: users
CREATE TABLE `users` (
  `id` int unsigned NOT NULL AUTO_INCREMENT,
  `uid` bigint NOT NULL,
  `created_at` datetime(3) NOT NULL,
  `updated_at` datetime(3) NOT NULL,
  `deleted_at` datetime(3) DEFAULT NULL,
  `name` varchar(100) COLLATE utf8mb4_general_ci NOT NULL DEFAULT '',
  `nickname` varchar(100) COLLATE utf8mb4_general_ci NOT NULL DEFAULT '',
  `email` varchar(100) COLLATE utf8mb4_general_ci NOT NULL,
  `avatar` varchar(100) COLLATE utf8mb4_general_ci NOT NULL DEFAULT '',
  `remark` varchar(100) COLLATE utf8mb4_general_ci NOT NULL DEFAULT '',
  `status` int NOT NULL DEFAULT '1',
  PRIMARY KEY (`id`),
  UNIQUE KEY `idx_users_uid` (`uid`),
  UNIQUE KEY `idx__user__email__deleted_at` (`deleted_at`,`email`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Table: webhooks
CREATE TABLE `webhooks` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `created_at` datetime(3) DEFAULT NULL,
  `updated_at` datetime(3) DEFAULT NULL,
  `creator` bigint DEFAULT NULL,
  `deleted_at` datetime(3) DEFAULT NULL,
  `namespace_uid` bigint DEFAULT NULL,
  `name` varchar(191) COLLATE utf8mb4_general_ci DEFAULT NULL,
  `app` int DEFAULT '0',
  `url` varchar(191) COLLATE utf8mb4_general_ci DEFAULT NULL,
  `method` int DEFAULT '0',
  `headers` json DEFAULT NULL,
  `secret` longtext COLLATE utf8mb4_general_ci,
  `status` int DEFAULT '0',
  PRIMARY KEY (`id`),
  UNIQUE KEY `webhook_config__namespace_uid__name` (`deleted_at`,`namespace_uid`,`name`),
  UNIQUE KEY `idx_webhooks_url` (`url`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

