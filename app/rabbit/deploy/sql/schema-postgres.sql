-- DDL from GORM models
-- Generated by schema tool
-- DO NOT EDIT THIS FILE DIRECTLY

-- Table: email_configs
CREATE TABLE "email_configs" (
  "id" bigint DEFAULT nextval('email_configs_id_seq'::regclass) NOT NULL,
  "created_at" timestamp(6) with time zone,
  "updated_at" timestamp(6) with time zone,
  "creator" bigint,
  "deleted_at" timestamp(6) with time zone,
  "namespace_uid" bigint,
  "name" character varying,
  "host" text,
  "port" integer,
  "username" text,
  "password" text,
  "status" integer DEFAULT 0,
  PRIMARY KEY ("id")
);
CREATE UNIQUE INDEX email_config__namespace_uid__name ON public.email_configs USING btree (deleted_at, namespace_uid, name);

-- Table: members
CREATE TABLE "members" (
  "id" bigint DEFAULT nextval('members_id_seq'::regclass) NOT NULL,
  "created_at" timestamp(6) with time zone NOT NULL,
  "updated_at" timestamp(6) with time zone NOT NULL,
  "deleted_at" timestamp(6) with time zone,
  "creator" bigint NOT NULL,
  "namespace_uid" bigint NOT NULL,
  "user_uid" bigint NOT NULL,
  "status" integer DEFAULT 1 NOT NULL,
  "name" character varying DEFAULT ''::character varying NOT NULL,
  "nickname" character varying DEFAULT ''::character varying NOT NULL,
  "avatar" character varying DEFAULT ''::character varying NOT NULL,
  "remark" character varying DEFAULT ''::character varying NOT NULL,
  "email" character varying DEFAULT ''::character varying NOT NULL,
  "phone" character varying DEFAULT ''::character varying NOT NULL,
  PRIMARY KEY ("id")
);
CREATE UNIQUE INDEX idx__member__namespace_uid__user_uid ON public.members USING btree (namespace_uid, user_uid);
CREATE INDEX idx_members_creator ON public.members USING btree (creator);
CREATE INDEX idx_members_deleted_at ON public.members USING btree (deleted_at);

-- Table: message_logs
CREATE TABLE "message_logs" (
  "id" bigint DEFAULT nextval('message_logs_id_seq'::regclass) NOT NULL,
  "created_at" timestamp(6) with time zone,
  "updated_at" timestamp(6) with time zone,
  "creator" bigint,
  "namespace_uid" bigint,
  "send_at" timestamp(6) with time zone,
  "message" text,
  "config" text,
  "type" integer DEFAULT 0,
  "status" integer DEFAULT 0,
  "retry_total" integer DEFAULT 0,
  "last_error" text,
  PRIMARY KEY ("id")
);
CREATE INDEX idx__message_log__namespace_uid ON public.message_logs USING btree (namespace_uid);

-- Table: message_retry_logs
CREATE TABLE "message_retry_logs" (
  "id" bigint DEFAULT nextval('message_retry_logs_id_seq'::regclass) NOT NULL,
  "created_at" timestamp(6) with time zone,
  "updated_at" timestamp(6) with time zone,
  "creator" bigint,
  "namespace_uid" bigint,
  "message_log_id" bigint,
  "retry_at" timestamp(6) with time zone,
  PRIMARY KEY ("id")
);
CREATE INDEX idx__message_retry_log__message_log_id ON public.message_retry_logs USING btree (message_log_id);
CREATE INDEX idx__message_retry_log__namespace_uid ON public.message_retry_logs USING btree (namespace_uid);

-- Table: namespaces
CREATE TABLE "namespaces" (
  "id" bigint DEFAULT nextval('namespaces_id_seq'::regclass) NOT NULL,
  "created_at" timestamp(6) with time zone NOT NULL,
  "updated_at" timestamp(6) with time zone NOT NULL,
  "creator" bigint NOT NULL,
  "deleted_at" timestamp(6) with time zone,
  "name" character varying NOT NULL,
  "metadata" json,
  "status" integer DEFAULT 0 NOT NULL,
  "remark" character varying DEFAULT ''::character varying NOT NULL,
  PRIMARY KEY ("id")
);
CREATE UNIQUE INDEX idx__namespace__name__deleted_at ON public.namespaces USING btree (deleted_at, name);
CREATE INDEX idx_namespaces_creator ON public.namespaces USING btree (creator);

-- Table: recipient_group__email_configs
CREATE TABLE "recipient_group__email_configs" (
  "recipient_group_id" bigint NOT NULL,
  "email_config_id" bigint NOT NULL,
  PRIMARY KEY ("recipient_group_id", "email_config_id")
);

-- Table: recipient_group__members
CREATE TABLE "recipient_group__members" (
  "recipient_group_id" bigint NOT NULL,
  "recipient_member_id" bigint NOT NULL,
  PRIMARY KEY ("recipient_group_id", "recipient_member_id")
);

-- Table: recipient_group__templates
CREATE TABLE "recipient_group__templates" (
  "recipient_group_id" bigint NOT NULL,
  "template_id" bigint NOT NULL,
  PRIMARY KEY ("recipient_group_id", "template_id")
);

-- Table: recipient_group__webhooks
CREATE TABLE "recipient_group__webhooks" (
  "recipient_group_id" bigint NOT NULL,
  "webhook_config_id" bigint NOT NULL,
  PRIMARY KEY ("recipient_group_id", "webhook_config_id")
);

-- Table: recipient_groups
CREATE TABLE "recipient_groups" (
  "id" bigint DEFAULT nextval('recipient_groups_id_seq'::regclass) NOT NULL,
  "created_at" timestamp(6) with time zone,
  "updated_at" timestamp(6) with time zone,
  "creator" bigint,
  "deleted_at" timestamp(6) with time zone,
  "namespace_uid" bigint,
  "name" character varying,
  "metadata" json,
  "status" integer DEFAULT 0,
  PRIMARY KEY ("id")
);
CREATE UNIQUE INDEX recipient_group__namespace_uid__name ON public.recipient_groups USING btree (deleted_at, namespace_uid, name);

-- Table: recipient_members
CREATE TABLE "recipient_members" (
  "id" bigint DEFAULT nextval('recipient_members_id_seq'::regclass) NOT NULL,
  "created_at" timestamp(6) with time zone,
  "updated_at" timestamp(6) with time zone,
  "creator" bigint,
  "namespace_uid" bigint,
  "user_uid" bigint,
  "email" text,
  "phone" text,
  "status" integer DEFAULT 0,
  PRIMARY KEY ("id")
);
CREATE UNIQUE INDEX recipient_member__namespace_uid__user_uid ON public.recipient_members USING btree (namespace_uid, user_uid);

-- Table: templates
CREATE TABLE "templates" (
  "id" bigint DEFAULT nextval('templates_id_seq'::regclass) NOT NULL,
  "created_at" timestamp(6) with time zone,
  "updated_at" timestamp(6) with time zone,
  "creator" bigint,
  "deleted_at" timestamp(6) with time zone,
  "namespace_uid" bigint,
  "name" character varying,
  "message_type" integer DEFAULT 0,
  "json_data" bytea,
  "status" integer DEFAULT 0,
  PRIMARY KEY ("id")
);
CREATE UNIQUE INDEX template__namespace_uid__name ON public.templates USING btree (deleted_at, namespace_uid, name);

-- Table: user_oauth2s
CREATE TABLE "user_oauth2s" (
  "id" bigint DEFAULT nextval('user_oauth2s_id_seq'::regclass) NOT NULL,
  "created_at" timestamp(6) with time zone NOT NULL,
  "updated_at" timestamp(6) with time zone NOT NULL,
  "open_id" character varying NOT NULL,
  "name" character varying DEFAULT ''::character varying NOT NULL,
  "email" character varying DEFAULT ''::character varying NOT NULL,
  "avatar" character varying DEFAULT ''::character varying NOT NULL,
  "app" character varying NOT NULL,
  "raw" json,
  "user_id" bigint NOT NULL,
  PRIMARY KEY ("id")
);
CREATE UNIQUE INDEX idx__oauth2_user__app__open_id ON public.user_oauth2s USING btree (open_id, app);
CREATE INDEX idx__oauth2_user__email ON public.user_oauth2s USING btree (email);
CREATE INDEX idx__oauth2_user__user_id ON public.user_oauth2s USING btree (user_id);

-- Table: users
CREATE TABLE "users" (
  "id" bigint DEFAULT nextval('users_id_seq'::regclass) NOT NULL,
  "created_at" timestamp(6) with time zone NOT NULL,
  "updated_at" timestamp(6) with time zone NOT NULL,
  "deleted_at" timestamp(6) with time zone,
  "name" character varying DEFAULT ''::character varying NOT NULL,
  "nickname" character varying DEFAULT ''::character varying NOT NULL,
  "email" character varying NOT NULL,
  "avatar" character varying DEFAULT ''::character varying NOT NULL,
  "remark" character varying DEFAULT ''::character varying NOT NULL,
  "status" integer DEFAULT 1 NOT NULL,
  PRIMARY KEY ("id")
);
CREATE UNIQUE INDEX idx__user__email__deleted_at ON public.users USING btree (deleted_at, email);

-- Table: webhooks
CREATE TABLE "webhooks" (
  "id" bigint DEFAULT nextval('webhooks_id_seq'::regclass) NOT NULL,
  "created_at" timestamp(6) with time zone,
  "updated_at" timestamp(6) with time zone,
  "creator" bigint,
  "deleted_at" timestamp(6) with time zone,
  "namespace_uid" bigint,
  "name" character varying,
  "app" integer DEFAULT 0,
  "url" character varying,
  "method" integer DEFAULT 0,
  "headers" json,
  "secret" text,
  "status" integer DEFAULT 0,
  PRIMARY KEY ("id")
);
CREATE UNIQUE INDEX idx_webhooks_url ON public.webhooks USING btree (url);
CREATE UNIQUE INDEX webhook_config__namespace_uid__name ON public.webhooks USING btree (deleted_at, namespace_uid, name);

