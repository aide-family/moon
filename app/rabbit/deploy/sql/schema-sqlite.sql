-- DDL from GORM models
-- Generated by schema tool
-- DO NOT EDIT THIS FILE DIRECTLY

-- Table: email_configs
CREATE TABLE `email_configs` (`id` integer PRIMARY KEY AUTOINCREMENT,`created_at` datetime,`updated_at` datetime,`creator` integer,`deleted_at` datetime,`namespace_uid` integer,`name` text,`host` text,`port` integer,`username` text,`password` text,`status` integer DEFAULT 0);
CREATE UNIQUE INDEX `email_config__namespace_uid__name` ON `email_configs`(`deleted_at`,`namespace_uid`,`name`);

-- Table: members
CREATE TABLE `members` (`id` integer PRIMARY KEY AUTOINCREMENT NOT NULL,`created_at` datetime NOT NULL,`updated_at` datetime NOT NULL,`deleted_at` datetime,`creator` integer NOT NULL,`namespace_uid` integer NOT NULL,`user_uid` integer NOT NULL,`status` integer NOT NULL DEFAULT 1,`name` text NOT NULL DEFAULT "",`nickname` text NOT NULL DEFAULT "",`avatar` text NOT NULL DEFAULT "",`remark` text NOT NULL DEFAULT "",`email` text NOT NULL DEFAULT "",`phone` text NOT NULL DEFAULT "");
CREATE UNIQUE INDEX `idx__member__namespace_uid__user_uid` ON `members`(`namespace_uid`,`user_uid`);
CREATE INDEX `idx_members_creator` ON `members`(`creator`);
CREATE INDEX `idx_members_deleted_at` ON `members`(`deleted_at`);

-- Table: message_logs
CREATE TABLE `message_logs` (`id` integer PRIMARY KEY AUTOINCREMENT,`created_at` datetime,`updated_at` datetime,`creator` integer,`namespace_uid` integer,`send_at` datetime,`message` text,`config` text,`type` integer DEFAULT 0,`status` integer DEFAULT 0,`retry_total` integer DEFAULT 0,`last_error` text);
CREATE INDEX `idx__message_log__namespace_uid` ON `message_logs`(`namespace_uid`);

-- Table: message_retry_logs
CREATE TABLE `message_retry_logs` (`id` integer PRIMARY KEY AUTOINCREMENT,`created_at` datetime,`updated_at` datetime,`creator` integer,`namespace_uid` integer,`message_log_id` integer,`retry_at` datetime);
CREATE INDEX `idx__message_retry_log__message_log_id` ON `message_retry_logs`(`message_log_id`);
CREATE INDEX `idx__message_retry_log__namespace_uid` ON `message_retry_logs`(`namespace_uid`);

-- Table: namespaces
CREATE TABLE `namespaces` (`id` integer PRIMARY KEY AUTOINCREMENT NOT NULL,`created_at` datetime NOT NULL,`updated_at` datetime NOT NULL,`creator` integer NOT NULL,`deleted_at` datetime,`name` varchar(100) NOT NULL,`metadata` json,`status` integer NOT NULL DEFAULT 0,`remark` varchar(1000) NOT NULL DEFAULT "");
CREATE UNIQUE INDEX `idx__namespace__name__deleted_at` ON `namespaces`(`deleted_at`,`name`);
CREATE INDEX `idx_namespaces_creator` ON `namespaces`(`creator`);

-- Table: recipient_group__email_configs
CREATE TABLE `recipient_group__email_configs` (`recipient_group_id` integer,`email_config_id` integer,PRIMARY KEY (`recipient_group_id`,`email_config_id`));

-- Table: recipient_group__members
CREATE TABLE `recipient_group__members` (`recipient_group_id` integer,`recipient_member_id` integer,PRIMARY KEY (`recipient_group_id`,`recipient_member_id`));

-- Table: recipient_group__templates
CREATE TABLE `recipient_group__templates` (`recipient_group_id` integer,`template_id` integer,PRIMARY KEY (`recipient_group_id`,`template_id`));

-- Table: recipient_group__webhooks
CREATE TABLE `recipient_group__webhooks` (`recipient_group_id` integer,`webhook_config_id` integer,PRIMARY KEY (`recipient_group_id`,`webhook_config_id`));

-- Table: recipient_groups
CREATE TABLE `recipient_groups` (`id` integer PRIMARY KEY AUTOINCREMENT,`created_at` datetime,`updated_at` datetime,`creator` integer,`deleted_at` datetime,`namespace_uid` integer,`name` text,`metadata` json,`status` integer DEFAULT 0);
CREATE UNIQUE INDEX `recipient_group__namespace_uid__name` ON `recipient_groups`(`deleted_at`,`namespace_uid`,`name`);

-- Table: recipient_members
CREATE TABLE `recipient_members` (`id` integer PRIMARY KEY AUTOINCREMENT,`created_at` datetime,`updated_at` datetime,`creator` integer,`namespace_uid` integer,`user_uid` integer,`email` text,`phone` text,`status` integer DEFAULT 0);
CREATE UNIQUE INDEX `recipient_member__namespace_uid__user_uid` ON `recipient_members`(`namespace_uid`,`user_uid`);

-- Table: templates
CREATE TABLE `templates` (`id` integer PRIMARY KEY AUTOINCREMENT,`created_at` datetime,`updated_at` datetime,`creator` integer,`deleted_at` datetime,`namespace_uid` integer,`name` text,`message_type` integer DEFAULT 0,`json_data` blob,`status` integer DEFAULT 0);
CREATE UNIQUE INDEX `template__namespace_uid__name` ON `templates`(`deleted_at`,`namespace_uid`,`name`);

-- Table: user_oauth2s
CREATE TABLE `user_oauth2s` (`id` integer PRIMARY KEY AUTOINCREMENT,`created_at` datetime NOT NULL,`updated_at` datetime NOT NULL,`open_id` varchar(100) NOT NULL,`name` varchar(100) NOT NULL DEFAULT "",`email` varchar(100) NOT NULL DEFAULT "",`avatar` varchar(100) NOT NULL DEFAULT "",`app` varchar(100) NOT NULL,`raw` json,`user_id` integer NOT NULL);
CREATE UNIQUE INDEX `idx__oauth2_user__app__open_id` ON `user_oauth2s`(`open_id`,`app`);
CREATE INDEX `idx__oauth2_user__email` ON `user_oauth2s`(`email`);
CREATE INDEX `idx__oauth2_user__user_id` ON `user_oauth2s`(`user_id`);

-- Table: users
CREATE TABLE `users` (`id` integer PRIMARY KEY AUTOINCREMENT NOT NULL,`created_at` datetime NOT NULL,`updated_at` datetime NOT NULL,`deleted_at` datetime,`name` varchar(100) NOT NULL DEFAULT "",`nickname` varchar(100) NOT NULL DEFAULT "",`email` varchar(100) NOT NULL,`avatar` varchar(100) NOT NULL DEFAULT "",`remark` varchar(100) NOT NULL DEFAULT "",`status` integer NOT NULL DEFAULT 1);
CREATE UNIQUE INDEX `idx__user__email__deleted_at` ON `users`(`deleted_at`,`email`);

-- Table: webhooks
CREATE TABLE `webhooks` (`id` integer PRIMARY KEY AUTOINCREMENT,`created_at` datetime,`updated_at` datetime,`creator` integer,`deleted_at` datetime,`namespace_uid` integer,`name` text,`app` integer DEFAULT 0,`url` text,`method` integer DEFAULT 0,`headers` json,`secret` text,`status` integer DEFAULT 0);
CREATE UNIQUE INDEX `idx_webhooks_url` ON `webhooks`(`url`);
CREATE UNIQUE INDEX `webhook_config__namespace_uid__name` ON `webhooks`(`deleted_at`,`namespace_uid`,`name`);

